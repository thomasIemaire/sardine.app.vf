<app-base-dialog
  [(visible)]="visible"
  title="Ajouter des fichiers"
  subtitle="Glissez-déposez vos fichiers ou parcourez votre ordinateur"
  icon="fa-duotone fa-solid fa-cloud-arrow-up"
  iconColor="blue"
  width="520px"
  [submitLabel]="submitLabel()"
  [canSubmit]="hasFiles()"
  [loading]="isUploading()"
  (submitted)="onSubmit()"
  (closed)="close()">

  <div
    class="dropzone"
    [class.dragging]="isDragging()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)">
    <input
      type="file"
      #fileInput
      [accept]="acceptedFormats"
      multiple
      hidden
      (change)="onFileSelect($event)" />

    <div class="dropzone-content">
      <div class="dropzone-icon">
        <i class="fa-duotone fa-solid fa-cloud-arrow-up"></i>
      </div>
      <p class="dropzone-text">
        <span class="dropzone-link" (click)="fileInput.click()">Cliquez pour parcourir</span>
        ou glissez-déposez vos fichiers ici
      </p>
      <p class="dropzone-formats">
        Formats acceptés : Images, PDF, Vidéos<br />
        Taille maximale : 100 Mo par fichier
      </p>
    </div>
  </div>

  @if (selectedFiles().length > 0) {
    <div class="files-list">
      @for (file of selectedFiles(); track file.name; let i = $index) {
        <div class="file-item">
          <div class="file-icon">
            <i [class]="getFileIcon(file.type)"></i>
          </div>
          <div class="file-details">
            <span class="file-name">{{ file.name }}</span>
            <span class="file-size">{{ formatSize(file.size) }}</span>
          </div>
          <p-button
            icon="fa-duotone fa-solid fa-xmark"
            size="small"
            text
            severity="secondary"
            (click)="removeFile(i)" />
        </div>
      }
    </div>
  }

</app-base-dialog>
